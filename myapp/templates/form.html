<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Терминдер</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    {% bootstrap_messages %}
</head>
<body style = "padding: 16px;">
    <h2>Термин сөздерді іздеу: файлдан оқу немесе мәтінді енгізу</h2>
    <form method="post" class = "form" enctype="multipart/form-data">
        {% csrf_token %}
        {% bootstrap_form form %}
        {% buttons %}
        <button type="submit" class="btn btn-primary">Іздеу</button>
        {% endbuttons %}
    </form>

    <!-- <div class="progress mt-3" style="height: 20px;" id="progress-bar-container">
        <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
    </div>

    <div class="mt-3" id="upload-status"></div> -->

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

    <!-- <script>
        const form = document.getElementById('upload-form');
        const progressBar = document.getElementById('progress-bar');
        const progressBarContainer = document.getElementById('progress-bar-container');
        const uploadStatus = document.getElementById('upload-status');
    
        form.addEventListener('submit', function(event) {
            event.preventDefault();  // Prevent the default form submission
    
            const formData = new FormData(form);
            const xhr = new XMLHttpRequest();
    
            xhr.open('POST', form.action, true);
    
            // Show progress bar container when file upload starts
            progressBarContainer.style.display = 'block';
    
            // Update progress bar during upload
            xhr.upload.onprogress = function(event) {
                if (event.lengthComputable) {
                    const percentage = Math.round((event.loaded / event.total) * 100);
                    progressBar.style.width = percentage + '%';
                    progressBar.textContent = percentage + '%';
                    progressBar.setAttribute('aria-valuenow', percentage);
                }
            };
    
            // Handle the response from the server
            xhr.onload = function() {
                console.log("Server response received", xhr.status, xhr.responseText); // Debugging line
                if (xhr.status === 200) {
                    const response = JSON.parse(xhr.responseText);
                    console.log("Parsed response: ", response);  // Debugging line
    
                    if (response.message === 'File uploaded successfully') {
                        progressBar.classList.remove('bg-danger');
                        progressBar.classList.add('bg-success');
                        progressBar.textContent = 'Upload Complete!';
                        uploadStatus.innerHTML = '<div class="alert alert-success">File uploaded successfully!</div>';
    
                        // Redirect to the result page after a delay
                        setTimeout(function() {
                            console.log("Redirecting to /result/");  // Debugging line
                            window.location.href = "/result/";  // Adjust this URL to match your result page
                        }, 2000);  // 2-second delay for showing completion message
                    } else {
                        uploadStatus.innerHTML = '<div class="alert alert-danger">' + response.error + '</div>';
                    }
                } else {
                    console.log("Upload failed", xhr.status);  // Debugging line
                    progressBar.classList.remove('bg-success');
                    progressBar.classList.add('bg-danger');
                    progressBar.textContent = 'Upload Failed!';
                    uploadStatus.innerHTML = '<div class="alert alert-danger">File upload failed. Please try again.</div>';
                }
            };
    
            // Handle errors during upload
            xhr.onerror = function() {
                console.log("AJAX error");  // Debugging line
                progressBar.classList.remove('bg-success');
                progressBar.classList.add('bg-danger');
                progressBar.textContent = 'Error!';
                uploadStatus.innerHTML = '<div class="alert alert-danger">An error occurred during the file upload. Please try again.</div>';
            };
    
            // Send the form data via AJAX
            xhr.send(formData);
        });
    </script> -->

</body>
</html>